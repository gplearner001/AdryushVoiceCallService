{
  "info": {
    "name": "Voice Agent API",
    "description": "Complete API collection for testing the Voice Agent service",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:3000",
      "type": "string"
    },
    {
      "key": "apiKey",
      "value": "test-api-key-12345",
      "type": "string"
    },
    {
      "key": "callId",
      "value": "",
      "type": "string"
    },
    {
      "key": "knowledgeBaseId",
      "value": "",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "Health Check",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{baseUrl}}/health",
          "host": ["{{baseUrl}}"],
          "path": ["health"]
        }
      },
      "response": []
    },
    {
      "name": "Create Knowledge Base",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "if (pm.response.code === 200) {",
              "    const response = pm.response.json();",
              "    pm.collectionVariables.set('knowledgeBaseId', response.knowledgeBase.id);",
              "    console.log('Knowledge Base ID saved:', response.knowledgeBase.id);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "X-API-Key",
            "value": "{{apiKey}}"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"name\": \"Customer Support KB\",\n  \"description\": \"Knowledge base for customer support inquiries\",\n  \"documents\": [\n    {\n      \"title\": \"Product Information\",\n      \"content\": \"Our main product is a cloud-based CRM system that helps businesses manage customer relationships. It includes contact management, sales pipeline tracking, and automated email campaigns. The system supports integrations with popular tools like Slack, Gmail, and Salesforce.\",\n      \"metadata\": {\n        \"category\": \"products\",\n        \"version\": \"1.0\"\n      }\n    },\n    {\n      \"title\": \"Pricing Plans\",\n      \"content\": \"We offer three pricing tiers: Basic ($29/month for up to 1,000 contacts), Professional ($79/month for up to 10,000 contacts), and Enterprise ($199/month for unlimited contacts). All plans include 24/7 support and a 30-day free trial.\",\n      \"metadata\": {\n        \"category\": \"pricing\",\n        \"version\": \"1.0\"\n      }\n    },\n    {\n      \"title\": \"Support Information\",\n      \"content\": \"Our support team is available 24/7 via phone, email, and live chat. Phone support: +1-800-555-0123. Email: support@company.com. Live chat is available on our website. We also have a comprehensive help center with tutorials and FAQs.\",\n      \"metadata\": {\n        \"category\": \"support\",\n        \"version\": \"1.0\"\n      }\n    }\n  ]\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/api/knowledge/bases",
          "host": ["{{baseUrl}}"],
          "path": ["api", "knowledge", "bases"]
        }
      }
    },
    {
      "name": "List Knowledge Bases",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "X-API-Key",
            "value": "{{apiKey}}"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/api/knowledge/bases",
          "host": ["{{baseUrl}}"],
          "path": ["api", "knowledge", "bases"]
        }
      }
    },
    {
      "name": "Query Knowledge Base",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "X-API-Key",
            "value": "{{apiKey}}"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"query\": \"What are your pricing plans?\",\n  \"maxResults\": 3\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/api/knowledge/bases/{{knowledgeBaseId}}/query",
          "host": ["{{baseUrl}}"],
          "path": ["api", "knowledge", "bases", "{{knowledgeBaseId}}", "query"]
        }
      }
    },
    {
      "name": "Initiate Call",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "if (pm.response.code === 200) {",
              "    const response = pm.response.json();",
              "    pm.collectionVariables.set('callId', response.callId);",
              "    console.log('Call ID saved:', response.callId);",
              "}"
            ]
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "X-API-Key",
            "value": "{{apiKey}}"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"phoneNumber\": \"+1234567890\",\n  \"knowledgeBaseId\": \"{{knowledgeBaseId}}\",\n  \"customPrompt\": \"You are a friendly customer service representative. Be helpful and professional. Keep responses concise since this is a phone conversation.\",\n  \"voiceConfig\": {\n    \"model\": \"neural\",\n    \"speed\": 1.0,\n    \"pitch\": 0\n  }\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/api/calls/initiate",
          "host": ["{{baseUrl}}"],
          "path": ["api", "calls", "initiate"]
        }
      }
    },
    {
      "name": "Get Call Status",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "X-API-Key",
            "value": "{{apiKey}}"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/api/calls/{{callId}}/status",
          "host": ["{{baseUrl}}"],
          "path": ["api", "calls", "{{callId}}", "status"]
        }
      }
    },
    {
      "name": "End Call",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "X-API-Key",
            "value": "{{apiKey}}"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/api/calls/{{callId}}/end",
          "host": ["{{baseUrl}}"],
          "path": ["api", "calls", "{{callId}}", "end"]
        }
      }
    },
    {
      "name": "Synthesize Speech",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "X-API-Key",
            "value": "{{apiKey}}"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"text\": \"Hello! This is a test of the voice synthesis system. How does this sound?\",\n  \"voiceConfig\": {\n    \"model\": \"neural\",\n    \"speed\": 1.0,\n    \"pitch\": 0\n  }\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/api/voice/synthesize",
          "host": ["{{baseUrl}}"],
          "path": ["api", "voice", "synthesize"]
        }
      }
    },
    {
      "name": "Generate AI Response",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "X-API-Key",
            "value": "{{apiKey}}"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"message\": \"What are your pricing plans?\",\n  \"context\": [\n    {\n      \"role\": \"user\",\n      \"content\": \"Hi, I'm interested in your CRM system\"\n    },\n    {\n      \"role\": \"assistant\",\n      \"content\": \"Hello! I'd be happy to help you learn about our CRM system. What would you like to know?\"\n    }\n  ],\n  \"knowledgeBaseId\": \"{{knowledgeBaseId}}\"\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/api/voice/generate-response",
          "host": ["{{baseUrl}}"],
          "path": ["api", "voice", "generate-response"]
        }
      }
    }
  ]
}